<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gar.lol</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Assistant&family=Libre+Baskerville&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --text-color: #222;
            --bg-color: #fff;
            --nav-hover-bg: #edf6fb;
            --social-icon-color: #444;
            --social-hover-color: #369;
            --logo-bg-color: #fff;
            --logo-box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --visibility-lightmode-only: visible;
            --visibility-darkmode-only: none;
        }

        [data-theme="dark"] {
            --text-color: #e4e4e4;
            --bg-color: #1a1a1a;
            --nav-hover-bg: #2a2a2a;
            --social-icon-color: #bbb;
            --social-hover-color: #69a;
            --logo-bg-color: #111;
            --logo-box-shadow: 0 0px 50px rgba(255, 255, 255, 0.7);
            --visibility-lightmode-only: none;
            --visibility-darkmode-only: visible;
        }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Assistant', sans-serif;
            color: var(--text-color);
            background-color: var(--bg-color);
            position: relative;
            overflow: hidden;
            transition: color 0.3s ease, background-color 0.3s ease;
        }

        .lightmode-only {
            display: var(--visibility-lightmode-only);
        }

        .darkmode-only {
            display: var(--visibility-darkmode-only);
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: -1;
        }

        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 10;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .theme-toggle:hover {
            background-color: var(--nav-hover-bg);
        }

        .theme-toggle svg {
            color: var(--text-color);
            transition: transform 0.5s ease;
        }

        .theme-toggle:hover svg {
            transform: rotate(45deg);
        }

        .logo-container, .content {
            position: relative;
            z-index: 1;
        }

        .logo-container {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background: var(--logo-bg-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--logo-box-shadow);
        }

        .logo-container img {
            width: 88px;
            height: 88px;
            object-fit: contain;
        }

        .content {
            margin-top: 2.4rem;
            font-family: 'Libre Baskerville', serif;
            position: absolute;
            top: calc(50% + 60px);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        .nav-links {
            list-style: none;
            display: flex;
            gap: .5rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-color);
            padding: .5rem;
            text-decoration: none;
            background-color: transparent;
            border-radius: 4px;
            transition: background-color 0.1s ease, color 0.3s ease;
        }

        .nav-links a:hover {
            background-color: var(--nav-hover-bg);
        }

        .social-links {
            list-style: none;
            display: flex;
            gap: 1.5rem;
        }

        .social-links a {
            color: var(--social-icon-color);
            transition: color 0.3s ease;
        }

        .social-links a:hover {
            color: var(--social-hover-color);
        }
    </style>
</head>
<body>
    <canvas id="bgCanvas"></canvas>

    <button class="theme-toggle" aria-label="Toggle theme">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sun-icon">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
    </button>

    <div class="logo-container">
        <img src="moonface.png" class="logo lightmode-only" alt="Logo">
        <img src="moonface_inverted.png" class="logo darkmode-only" alt="Logo">
    </div>

    <div class="content">
        <nav>
            <ul class="nav-links">
                <li><a href="#">Writings</a></li>
                <li><a href="#">Music</a></li>
                <li><a href="#">Art</a></li>
                <li><a href="#">Projects</a></li>
            </ul>
        </nav>

        <div class="social-links">
            <a href="https://github.com/rothos" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
            </a>
            <a href="https://twitter.com/moonboi_" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/></svg>
            </a>
            <a href="https://instagram.com/rothosphere" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
            </a>
            <a href="mailto:&#104;&#114;&#111;&#116;&#104;&#103;&#97;&#114;&#114;&#114;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;" class="email-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
            </a>
        </div>
    </div>

    <script>
        // Theme configuration
        const themeConfig = {
            light: {
                animation: {
                    speed: -0.08,
                    targetFPS: 60,
                    timeScale: 0.03
                },
                spiral: {
                    tightness: 180,
                    radialWave: {
                        amplitude: 0.1,
                        length: 12,
                        speed: 0.8
                    }
                },
                rendering: {
                    spiralPixelSize: 4,
                    noisePixelSize: 1
                },
                noise: {
                    intensity: 0.066,
                    spread: 40,
                    updateFraction: 0.3,
                    tileSize: 200
                },
                color: {
                    saturation: 70,
                    lightness: 80
                }
            },
            dark: {
                animation: {
                    speed: -0.08,
                    targetFPS: 60,
                    timeScale: 0.03
                },
                spiral: {
                    tightness: 180,
                    radialWave: {
                        amplitude: 0.1,
                        length: 12,
                        speed: 0.8
                    }
                },
                rendering: {
                    spiralPixelSize: 4,
                    noisePixelSize: 1
                },
                noise: {
                    intensity: 0.066,
                    spread: 40,
                    updateFraction: 0.3,
                    tileSize: 200
                },
                color: {
                    saturation: 27,
                    lightness: 20
                }
            }
        };

        // Theme management
        let currentTheme = 'light';
        let config = themeConfig[currentTheme];

        function getPreferredTheme() {
            const hours = new Date().getHours();
            return hours >= 6 && hours < 20 ? 'light' : 'dark';
        }

        function setTheme(theme) {
            currentTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            config = themeConfig[theme];
            
            // Update theme toggle icon
            const themeToggle = document.querySelector('.theme-toggle');
            if (theme === 'dark') {
                themeToggle.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="moon-icon">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                `;
            } else {
                themeToggle.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sun-icon">
                        <circle cx="12" cy="12" r="5"/>
                        <line x1="12" y1="1" x2="12" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="23"/>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                        <line x1="1" y1="12" x2="3" y2="12"/>
                        <line x1="21" y1="12" x2="23" y2="12"/>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                    </svg>
                `;
            }
        }

        // Initialize theme
        setTheme(getPreferredTheme());

        // Theme toggle functionality
        document.querySelector('.theme-toggle').addEventListener('click', () => {
            setTheme(currentTheme === 'light' ? 'dark' : 'light');
        });

        // Canvas setup and animation code (rest remains the same)
        const canvas = document.getElementById('bgCanvas');
        const ctx = canvas.getContext('2d');

        // State management
        let time = 0;
        let noiseArray = [];
        let lastFrameTime = 0;

        // Canvas sizing
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        // Noise generation and management
        function initializeNoiseArray() {
            const tilesPerRow = Math.ceil(config.noise.tileSize / config.rendering.noisePixelSize);
            noiseArray = new Array(tilesPerRow * tilesPerRow)
                .fill(0)
                .map(() => generateGaussianNoise(config.noise.spread));
        }

        function updateNoiseArray() {
            const tilesPerRow = Math.ceil(config.noise.tileSize / config.rendering.noisePixelSize);
            const totalTiles = tilesPerRow * tilesPerRow;
            const tilesToUpdate = Math.floor(totalTiles * config.noise.updateFraction);
            
            for (let i = 0; i < tilesToUpdate; i++) {
                const randomIndex = Math.floor(Math.random() * totalTiles);
                noiseArray[randomIndex] = generateGaussianNoise(config.noise.spread);
            }
        }

        // Color utilities
        function hslToRgb(h, s, l) {
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }

        function generateGaussianNoise(spread) {
            const u = 1 - Math.random();
            const v = 1 - Math.random();
            return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v) * spread;
        }

        function clamp(value, min, max) {
            return Math.max(min, Math.min(max, value));
        }

        // Main rendering function
        function renderSpiralGradient(currentTime) {
            // Calculate frame timing
            const deltaTime = (currentTime - lastFrameTime) / 1000;
            lastFrameTime = currentTime;

            // Skip frame if too much time has passed
            if (deltaTime > 1/15) {
                requestAnimationFrame(renderSpiralGradient);
                return;
            }

            const timeIncrement = config.animation.timeScale * (deltaTime * config.animation.targetFPS);
            const { width, height } = canvas;
            const centerX = width / 2;
            const centerY = height / 2;
            const imageData = ctx.createImageData(width, height);
            const data = imageData.data;

            // Render spiral pattern
            for (let y = 0; y < height; y += config.rendering.spiralPixelSize) {
                for (let x = 0; x < width; x += config.rendering.spiralPixelSize) {
                    const dx = (x + config.rendering.spiralPixelSize/2) - centerX;
                    const dy = (y + config.rendering.spiralPixelSize/2) - centerY;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    const baseAngle = Math.atan2(dy, dx);
                    
                    const safeDistance = Math.max(distance, 0.1);
                    let pixelValue = (
                        baseAngle + 
                        (distance/config.spiral.tightness) * (
                            0.5 + Math.sin(4 + 3*time*config.animation.speed)/Math.sqrt(safeDistance)*6 +
                            config.spiral.radialWave.amplitude * 
                            Math.sin(distance/config.spiral.radialWave.length - time*config.spiral.radialWave.speed)
                        ) + 
                        time * config.animation.speed
                    ) / (2 * Math.PI);

                    pixelValue = ((pixelValue % 1) + 1) % 1;
                    const [r, g, b] = hslToRgb(
                        pixelValue,
                        config.color.saturation / 100,
                        config.color.lightness / 100
                    );

                    // Apply noise to pixel blocks
                    for (let blockY = 0; blockY < config.rendering.spiralPixelSize && y + blockY < height; blockY++) {
                        for (let blockX = 0; blockX < config.rendering.spiralPixelSize && x + blockX < width; blockX++) {
                            const tileX = Math.floor((x + blockX) / config.rendering.noisePixelSize);
                            const tileY = Math.floor((y + blockY) / config.rendering.noisePixelSize);
                            const tilesPerRow = Math.ceil(config.noise.tileSize / config.rendering.noisePixelSize);
                            const noiseIndex = (tileY % tilesPerRow) * tilesPerRow + (tileX % tilesPerRow);
                            const noise = noiseArray[noiseIndex];

                            const noisyColor = [
                                clamp(r + noise * config.noise.intensity, 0, 255),
                                clamp(g + noise * config.noise.intensity, 0, 255),
                                clamp(b + noise * config.noise.intensity, 0, 255)
                            ];

                            const index = ((y + blockY) * width + (x + blockX)) * 4;
                            data[index] = noisyColor[0];
                            data[index + 1] = noisyColor[1];
                            data[index + 2] = noisyColor[2];
                            data[index + 3] = 255;
                        }
                    }
                }
            }

            ctx.putImageData(imageData, 0, 0);
            time += timeIncrement;
            updateNoiseArray();
            requestAnimationFrame(renderSpiralGradient);
        }

        // Initialize and start animation
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        initializeNoiseArray();
        requestAnimationFrame(renderSpiralGradient);
    </script>
</body>
</html>
